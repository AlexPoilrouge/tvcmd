#! /usr/bin/env python

import sys, os
import logging


def interactive():
    import readline
    import rlcompleter
    readline.parse_and_bind("tab: complete")
    
    import code
    code.interact(local=globals())
    
def main(argv):
    import tvcmd.cli
    
    ui = tvcmd.cli.Cmd()
    ui.load()
    
    # print torrent urls and exit
    if "-t" in argv:
        ui.onecmd("tor *")
    # main execution mode
    else:
        ui.cmdloop()
    
if __name__ == "__main__":
    
    # NORMAL mode
    if not os.environ.get("DEBUG"):
        logging.basicConfig(level=logging.INFO)
        main(sys.argv)
        sys.exit(0)
    
    # DEBUG mode
    logging.basicConfig(level=logging.DEBUG)
    sys.path.insert(0, os.path.dirname(__file__)+"/..")
    
    import traceback
    
    try: main(sys.argv)
    except: traceback.print_exc()
    
    interactive()

